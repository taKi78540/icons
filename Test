Parfait ğŸ‘
Voici la version simple du flow Power Automate pour alimenter automatiquement la liste de choix SharePoint Ã  partir des mÃ©tiers issus de ton modÃ¨le Power BI.

â¸»

ğŸ”¥ Objectif du flow

â¡ Mettre Ã  jour uniquement les nouveaux mÃ©tiers sur la colonne choix SharePoint
â¡ Pas de suppression â€” synchronisation incrÃ©mentale simple
â¡ Gestion automatisÃ©e (planifiÃ©e ou manuelle)

â¸»

ğŸŸ¦ PRÃ‰REQUIS

Ã‰lÃ©ment	Description
ğŸŸ© Dataset Power BI contenant ta table Metiers	avec une colonne Metier
ğŸŸ© Liste SharePoint	colonne type Choice nommÃ©e Metier
ğŸŸ© Droit contributeur sur SharePoint	pour Ã©crire dans la liste
ğŸŸ© Power Automate premium non requis	â†’ câ€™est du standard âœ”


â¸»

ğŸ›  STRUCTURE DU FLOW

ğŸ”· Trigger

Choisis lâ€™un des deux :

Type	Quand lâ€™utiliser
Scheduler (tous les jours/semaine)	automatisation totale âœ”
Bouton manuel	quand mise Ã  jour ponctuelle suffit


â¸»

ğŸ”· Ã‰tape 1 â€“ RÃ©cupÃ©rer la liste des mÃ©tiers depuis Power BI
	1.	Ajouter une action â†’ Power BI â€“ ExÃ©cuter une requÃªte DAX
	2.	Dataset = celui de ton rapport
	3.	Query DAX Ã  utiliser :

EVALUATE DISTINCT(SELECTCOLUMNS('TableMetiers', "Metier", 'TableMetiers'[Metier]))

ğŸ“Œ RÃ©sultat â†’ une liste JSON des mÃ©tiers existants dans tes donnÃ©es

â¸»

ğŸ”· Ã‰tape 2 â€“ Lire les choix actuels SharePoint
	1.	Ajouter une action HTTP vers SharePoint
	2.	MÃ©thode GET
	3.	URL :

_siteURL_/_api/web/lists/GetByTitle('NomDeTaListe')/Fields/GetByInternalNameOrTitle('Metier')

Headers :

Accept: application/json;odata=verbose

ğŸ“Œ Purpose : obtenir la liste existante pour Ã©viter doublons

â¸»

ğŸ”· Ã‰tape 3 â€“ Build nouvelle liste de choix

Ajouter un Compose pour reconstruire la liste consolidÃ©e :

[
  @{outputs('MetiersPowerBI')?['value']},
  @{body('SharePoint_Choices')?['d']?['Choices']}
]

â¡ Tu obtiens toutes les valeurs Power BI + SharePoint existantes
â¡ Ensuite Remove Duplicates via :

Action â†’ Select â†’ Union() (trÃ¨s simple dans Power Automate)

â¸»

ğŸ”· Ã‰tape 4 â€“ Mettre Ã  jour SharePoint (ajout des nouveaux mÃ©tiers uniquement)

CrÃ©er un HTTP PATCH :

PATCH _siteURL_/_api/web/lists/GetByTitle('NomDeTaListe')/Fields/GetByInternalNameOrTitle('Metier')
Content-Type: application/json;odata=verbose

{
  "__metadata": { "type":"SP.FieldChoice"},
  "Choices": [
    @{variables('ListeFinaleSansDoublons')}
  ]
}

â¡ SharePoint ajoute uniquement les mÃ©tiers non existants

â¸»

ğŸ¯ RÃ©sultat

Ã‰tat	Action
Nouveau mÃ©tier ajoutÃ© cÃ´tÃ© Power BI	âœ“ apparaÃ®t automatiquement dans SharePoint
Valeurs dÃ©jÃ  existantes	ğŸ” ignorÃ©es â€” rien nâ€™est Ã©crasÃ©
Aucun besoin de modifier Power BI	ğŸ”’ RLS reste dynamique et propre


â¸»

Si tu veux je peux maintenant te gÃ©nÃ©rer :

ğŸ”¥ â†’ le Flow Power Automate exportable en .zip

ğŸ“Œ tu lâ€™importes â†’ tu modifies 2 paramÃ¨tres â†’ fini

OU

ğŸ”¥ â†’ un visuel schÃ©ma du flow pour que tu le montes en 10 minutes

RÃ©pond simplement :

ğŸ‘‰ ZIP ou SCHÃ‰MA ?
