Super projet ğŸ‘Œ Voici le â€œkitâ€ des endpoints Microsoft Graph Reports qui donnent des statistiques agrÃ©gÃ©es (pas besoin de requÃªter 200 000 users individuellement) pour les outils M365. Pour chaque outil, je te liste les requÃªtes utiles (v1.0 quand câ€™est possible) et les indicateurs disponibles. Tous ces endpoints exigent en gÃ©nÃ©ral lâ€™autorisation Reports.Read.All (delegated ou app) et retournent un CSV (paramÃ¨tre period='D7'|'D30'|'D90'|'D180').  ï¿¼

Outlook / Exchange (courriel)
	â€¢	/reports/getEmailActivityCounts(period=â€˜D30â€™) â†’ volumes quotidiens dâ€™emails envoyÃ©s, lus, reÃ§us (tendance org-wide). Indicateurs : Report Refresh Date, Send Count, Read Count, Receive Count par jour.  ï¿¼
	â€¢	/reports/getEmailActivityUserCounts(period=â€˜D30â€™) â†’ nb dâ€™utilisateurs uniques actifs par type dâ€™activitÃ© (envoi/lecture/rÃ©ception), par jour.  ï¿¼
(Si besoin de dÃ©tail par utilisateur : /getEmailActivityUserDetail mais cela devient nominatif.)  ï¿¼

OneDrive for Business
	â€¢	/reports/getOneDriveUsageFileCounts(period=â€˜D30â€™) â†’ nb de fichiers total/actifs, fichiers ajoutÃ©s/supprimÃ©s (tendance).
	â€¢	/reports/getOneDriveUsageStorage(period=â€˜D30â€™) â†’ stockage allouÃ© vs utilisÃ© et variation.
	â€¢	/reports/getOneDriveUsageAccountDetail(date=â€˜YYYY-MM-DDâ€™ ou period) â†’ vue dÃ©taillÃ©e (par compte) : taille utilisÃ©e, fichiers totaux/actifs, derniÃ¨re activitÃ© (Ã  utiliser prudemment si tu veux Ã©viter le nominatif).  ï¿¼
(La doc OneDrive regroupe toutes les vues â€œusageâ€ dans la section Reports.)  ï¿¼

SharePoint Online
	â€¢	/reports/getSharePointSiteUsageFileCounts(period=â€˜D30â€™) â†’ nb de fichiers par jour (total/actifs).
	â€¢	/reports/getSharePointSiteUsageStorage(period=â€˜D30â€™) â†’ stockage par site (agrÃ©gable).
	â€¢	/reports/getSharePointActivityFileCounts(period=â€˜D30â€™) â†’ vues/visites/partages Ã  lâ€™Ã©chelle tenant.
(Les pages â€œworking with M365 usage reportsâ€ listent ces variations.)  ï¿¼

Microsoft Teams
	â€¢	/reports/getTeamsUserActivityCounts(period=â€˜D30â€™) â†’ nb dâ€™activitÃ©s par type (messages de canal, rÃ©unions organisÃ©es/participÃ©es, appels, actions de chat, etc.), par jour. IdÃ©al pour les tendances org-wide.  ï¿¼
	â€¢	/reports/getTeamsDeviceUsageUserCounts(period=â€˜D30â€™) â†’ rÃ©partition par type dâ€™appareil/plateforme (Desktop, Web, Mobile) â€” utile pour comprendre les usages et guider la com. (RÃ©fÃ©rence dans la famille â€œTeams device usageâ€.)  ï¿¼
	â€¢	/reports/getTeamsTeamActivityCounts(period=â€˜D30â€™) â†’ activitÃ© au niveau des Ã©quipes (messages, mentions, rÃ©ponses). (Toujours en Reports.)  ï¿¼
(DÃ©tail nominatif existe: /getTeamsUserActivityUserDetail â€” Ã  Ã©viter si tu veux rester 100 % agrÃ©gÃ©.)  ï¿¼

Microsoft 365 (vue globale locataire)
	â€¢	/reports/getOffice365ActiveUserCounts(period=â€˜D30â€™) â†’ utilisateurs actifs par service (Exchange, OneDrive, SharePoint, Teams, Yammer/Viva Engage, etc.), tendance.
	â€¢	/reports/getOffice365ServicesUserCounts(period=â€˜D30â€™) â†’ pÃ©nÃ©tration par service (nb dâ€™utilisateurs actifs vs licenciÃ©s).
(Ces deux rapports â€œOffice 365 usageâ€ sont la meilleure base pour un tableau de bord dâ€™adoption.)  ï¿¼

Groups (M365 Groups)
	â€¢	/reports/getOffice365GroupsActivityCounts(period=â€˜D30â€™) â†’ posts, fichiers, invitÃ©s, etc.
	â€¢	/reports/getOffice365GroupsActivityStorage(period=â€˜D30â€™) â†’ stockage consommÃ© par les groupes.  ï¿¼

Viva Engage (ex-Yammer)
	â€¢	/reports/getYammerActivityCounts(period=â€˜D30â€™) â†’ messages lus/postÃ©s, likes, etc.
	â€¢	/reports/getYammerDeviceUsageUserCounts(period=â€˜D30â€™) â†’ rÃ©partition device.  ï¿¼

Impressions / impressions techniques utiles
	â€¢	PÃ©riode : period='D7'|'D30'|'D90'|'D180' ou certaines vues acceptent date='YYYY-MM-DD'. Les CSV contiennent des en-tÃªtes stables (dates de rafraÃ®chissement, tenant id masquÃ© ou non selon paramÃ¨tre dâ€™anonymisation).  ï¿¼
	â€¢	Permissions : privilÃ©gie application permission Reports.Read.All sur une app Entra pour automatiser sans user context.  ï¿¼
	â€¢	Livrables : quasiment tous ces endpoints retournent un flux CSV (tu ingÃ¨res ensuite dans ton datapipeline/Power BI/Databricks).  ï¿¼

â¸»

Exemple dâ€™appels (format)
	â€¢	Teams â€“ activitÃ©s agrÃ©gÃ©es 30 jours
GET https://graph.microsoft.com/v1.0/reports/getTeamsUserActivityCounts(period='D30') â†’ CSV : colonnes par type dâ€™activitÃ© et lignes par date.  ï¿¼
	â€¢	Outlook â€“ tendances dâ€™email
GET https://graph.microsoft.com/v1.0/reports/getEmailActivityCounts(period='D30') â†’ Send Count, Read Count, Receive Count par jour.  ï¿¼
	â€¢	OneDrive â€“ stockage
GET https://graph.microsoft.com/v1.0/reports/getOneDriveUsageStorage(period='D30') â†’ stockage total/used et deltas. (Famille OneDrive usage.)  ï¿¼

â¸»

Pour ton angle â€œempreinte carboneâ€

Ces rapports te donnent volumes (stockage, activitÃ©s, rÃ©unions, messages, fichiers, etc.). Pour un 1er modÃ¨le de carbone dâ€™usage :
	â€¢	Stockage : mapper GoÂ·jour â†’ kgCOâ‚‚e via facteur dâ€™Ã©mission (datacenter + rÃ©seau + pÃ©riphÃ©riques, selon ton rÃ©fÃ©rentiel interne RSE).
	â€¢	Transferts / activitÃ©s : utiliser proxys (ex. messages, rÃ©unions/visio, vues/visites de fichiers) pour estimer donnÃ©es Ã©changÃ©es â†’ facteur dâ€™Ã©mission rÃ©seau/compute.
	â€¢	Appareils : croiser avec Teams Device Usage pour pondÃ©rer par terminal (desktop vs mobile).  ï¿¼

Si tu veux, je te prÃ©pare une liste exacte dâ€™endpoints Ã  appeler (par service) + mapping colonnes â†’ indicateurs carbone et un schÃ©ma dâ€™ingestion (Graph â†’ Azure Storage/Log Analytics â†’ Power BI) prÃªt Ã  coller dans ta roadmap Le Comptoir.
