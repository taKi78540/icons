@startuml
title Decision Tree â€” Request vs Incident

start

:Equipment scanned;

if (Equipment found in HAM?) then (Yes)
  :Read Owner OU from HAM;
else (No)
  :Use Visitor Business Entity (fallback);
endif

:Determine reference country;

:Query SharePoint eligibility matrix;

if (Rule found in SharePoint?) then (Yes)
  if (Assets exhaustive in HAM?) then (Yes)
    if (Catalog Group eligible?) then (Yes)
      :RequestAllowed = TRUE;
    else (No)
      :RequestAllowed = FALSE;
    endif
  else (No)
    :RequestAllowed = FALSE;
  endif
else (No)
  :RequestAllowed = FALSE;
endif

if (RequestAllowed = TRUE) then (Yes)
  if (Existing Request found?) then (Yes)
    :Update existing Request;
  else (No)
    :Create new Request;
  endif
  :Generate PV (PDF);
  :Store PV in SharePoint;
  :Link PV to Request;
else (No)
  :Create ServiceNow Incident;
  :Generate PV (PDF);
  :Store PV in SharePoint;
  :Link PV to Incident;
endif

stop
@enduml
